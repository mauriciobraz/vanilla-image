name: install-warp
type: shell
commands:
  - curl -fsSL https://pkg.cloudflareclient.com/pubkey.gpg |\
    gpg --yes --dearmor --output /usr/share/keyrings/cloudflare-warp-archive-keyring.gpg

  - export OS_VERSION=$(lsb_release -cs 2>/dev/null || \
    grep VERSION_CODENAME /etc/os-release | cut -d= -f2)

  - echo 'deb [signed-by=/usr/share/keyrings/cloudflare-warp-archive-keyring.gpg] \
    https://pkg.cloudflareclient.com/ $OS_VERSION main' | \
    tee /etc/apt/sources.list.d/cloudflare-client.list

  - apt update
  - apt upgrade -y

  - apt install cloudflare-warp
